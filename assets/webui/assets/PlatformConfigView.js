import{d as v,r,o as w,c as y,a as l,f as u,u as b,g as k,h as x,S as C,_ as S}from"./index.js";import{u as V,a as B}from"./use-message.js";const P={class:"sub-content-wrapper"},T={class:"sidebar-wrapper"},j={class:"sub-main-content-wrapper"},O=v({__name:"PlatformConfigView",setup(N){b();const p=k(),f=[{key:"onebot",text:"OneBot",path:"/platforms/onebot"},{key:"telegram",text:"Telegram",path:"/platforms/telegram"},{key:"discord",text:"Discord",path:"/platforms/discord"},{key:"wecom",text:"企业微信",path:"/platforms/wecom"},{key:"http",text:"HTTP 接口",path:"/platforms/http"}],o=V(),a=r(p.params.name||"onebot"),c=r([]),i=r({}),n=B();async function m(){const t=await(await fetch("/backend-api/v1/config?key="+a.value+"&type=schema")).json();c.value=[t]}async function d(){const t=await(await fetch("/backend-api/v1/config?key="+a.value+"&type=value")).json();i.value=t}function g(e){a.value=e,s()}function s(){o.start(),m().then(()=>d()).then(()=>{o.finish()}).catch(e=>{n.error("配置读取失败："+e),o.error()})}function _(e){o.start(),console.log(e),fetch("/backend-api/v1/config?key="+a.value,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(t=>{if(t.ok)return o.finish(),n.success("配置保存成功"),t.text();throw new Error("Something went wrong.")}).catch(t=>{n.error("配置保存失败："+t),o.error()})}return s(),(e,t)=>{const h=x("router-view");return w(),y("div",P,[l("div",T,[u(C,{"nav-list":f,onOnSelect:g,"icon-only":!1,title:"平台设置"})]),l("div",j,[u(h,{title:a.value,"configuration-groups":c.value,configurationValue:i.value,onSave:_,onReset:s},null,8,["title","configuration-groups","configurationValue"])])])}}});const L=S(O,[["__scopeId","data-v-b9a58cbf"]]);export{L as default};
